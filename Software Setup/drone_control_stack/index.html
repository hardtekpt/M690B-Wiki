
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Francisco Santos">
      
      
        <link rel="canonical" href="https://hardtekpt.github.io/M690B-Wiki/Software%20Setup/drone_control_stack/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.3.9">
    
    
      
        <title>Drone Control Stack Setup - M690B Wiki</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.1d29e8d0.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#drone-control-stack-setup" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="M690B Wiki" class="md-header__button md-logo" aria-label="M690B Wiki" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5.5 1C8 1 10 3 10 5.5c0 .88-.25 1.7-.69 2.4l.1.1h5.18l.1-.1c-.44-.7-.69-1.52-.69-2.4C14 3 16 1 18.5 1S23 3 23 5.5 21 10 18.5 10c-.88 0-1.7-.25-2.4-.69l-1.1 1.1v3.18l1.1 1.1c.7-.44 1.52-.69 2.4-.69 2.5 0 4.5 2 4.5 4.5S21 23 18.5 23 14 21 14 18.5c0-.88.25-1.7.69-2.4l-.1-.1H9.41l-.1.1c.44.7.69 1.52.69 2.4C10 21 8 23 5.5 23S1 21 1 18.5 3 14 5.5 14c.88 0 1.7.25 2.4.69l1.1-1.1v-3.18l-1.1-1.1c-.7.44-1.52.69-2.4.69C3 10 1 8 1 5.5S3 1 5.5 1m0 2A2.5 2.5 0 0 0 3 5.5 2.5 2.5 0 0 0 5.5 8 2.5 2.5 0 0 0 8 5.5 2.5 2.5 0 0 0 5.5 3m0 13A2.5 2.5 0 0 0 3 18.5 2.5 2.5 0 0 0 5.5 21 2.5 2.5 0 0 0 8 18.5 2.5 2.5 0 0 0 5.5 16m13-13A2.5 2.5 0 0 0 16 5.5 2.5 2.5 0 0 0 18.5 8 2.5 2.5 0 0 0 21 5.5 2.5 2.5 0 0 0 18.5 3m0 13a2.5 2.5 0 0 0-2.5 2.5 2.5 2.5 0 0 0 2.5 2.5 2.5 2.5 0 0 0 2.5-2.5 2.5 2.5 0 0 0-2.5-2.5M3.91 17.25l1.13.66c.13-.1.29-.16.46-.16a.75.75 0 0 1 .75.75l-.01.1 1.13.65-.28.5-1.13-.66c-.13.1-.29.16-.46.16a.75.75 0 0 1-.75-.75l.01-.1-1.13-.65.28-.5m-.28-11 1.13-.65-.01-.1a.75.75 0 0 1 .75-.75c.17 0 .33.06.46.16l1.13-.66.28.5-1.13.65.01.1a.75.75 0 0 1-.75.75c-.17 0-.33-.06-.46-.16l-1.13.66-.28-.5m13.28-2 1.13.66c.13-.1.29-.16.46-.16a.75.75 0 0 1 .75.75l-.01.1 1.13.65-.28.5-1.13-.66c-.13.1-.29.16-.46.16a.75.75 0 0 1-.75-.75l.01-.1-1.13-.65.28-.5m-.28 15 1.12-.75a.75.75 0 0 1 .75-.75c.17 0 .33.06.46.16l1.13-.66.28.5-1.12.75a.75.75 0 0 1-.75.75c-.17 0-.33-.06-.46-.16l-1.13.66-.28-.5Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            M690B Wiki
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Drone Control Stack Setup
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/hardtekpt/M690B-Wiki" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    M690B-Wiki
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Introduction
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../Vehicle%20Setup/" class="md-tabs__link md-tabs__link--active">
        Vehicle Setup
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../known_issues/" class="md-tabs__link">
      Known Issues
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../Mission%20Logs/" class="md-tabs__link">
        Mission Logs
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../roadmap/" class="md-tabs__link">
      Roadmap
    </a>
  </li>

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="M690B Wiki" class="md-nav__button md-logo" aria-label="M690B Wiki" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5.5 1C8 1 10 3 10 5.5c0 .88-.25 1.7-.69 2.4l.1.1h5.18l.1-.1c-.44-.7-.69-1.52-.69-2.4C14 3 16 1 18.5 1S23 3 23 5.5 21 10 18.5 10c-.88 0-1.7-.25-2.4-.69l-1.1 1.1v3.18l1.1 1.1c.7-.44 1.52-.69 2.4-.69 2.5 0 4.5 2 4.5 4.5S21 23 18.5 23 14 21 14 18.5c0-.88.25-1.7.69-2.4l-.1-.1H9.41l-.1.1c.44.7.69 1.52.69 2.4C10 21 8 23 5.5 23S1 21 1 18.5 3 14 5.5 14c.88 0 1.7.25 2.4.69l1.1-1.1v-3.18l-1.1-1.1c-.7.44-1.52.69-2.4.69C3 10 1 8 1 5.5S3 1 5.5 1m0 2A2.5 2.5 0 0 0 3 5.5 2.5 2.5 0 0 0 5.5 8 2.5 2.5 0 0 0 8 5.5 2.5 2.5 0 0 0 5.5 3m0 13A2.5 2.5 0 0 0 3 18.5 2.5 2.5 0 0 0 5.5 21 2.5 2.5 0 0 0 8 18.5 2.5 2.5 0 0 0 5.5 16m13-13A2.5 2.5 0 0 0 16 5.5 2.5 2.5 0 0 0 18.5 8 2.5 2.5 0 0 0 21 5.5 2.5 2.5 0 0 0 18.5 3m0 13a2.5 2.5 0 0 0-2.5 2.5 2.5 2.5 0 0 0 2.5 2.5 2.5 2.5 0 0 0 2.5-2.5 2.5 2.5 0 0 0-2.5-2.5M3.91 17.25l1.13.66c.13-.1.29-.16.46-.16a.75.75 0 0 1 .75.75l-.01.1 1.13.65-.28.5-1.13-.66c-.13.1-.29.16-.46.16a.75.75 0 0 1-.75-.75l.01-.1-1.13-.65.28-.5m-.28-11 1.13-.65-.01-.1a.75.75 0 0 1 .75-.75c.17 0 .33.06.46.16l1.13-.66.28.5-1.13.65.01.1a.75.75 0 0 1-.75.75c-.17 0-.33-.06-.46-.16l-1.13.66-.28-.5m13.28-2 1.13.66c.13-.1.29-.16.46-.16a.75.75 0 0 1 .75.75l-.01.1 1.13.65-.28.5-1.13-.66c-.13.1-.29.16-.46.16a.75.75 0 0 1-.75-.75l.01-.1-1.13-.65.28-.5m-.28 15 1.12-.75a.75.75 0 0 1 .75-.75c.17 0 .33.06.46.16l1.13-.66.28.5-1.12.75a.75.75 0 0 1-.75.75c-.17 0-.33-.06-.46-.16l-1.13.66-.28-.5Z"/></svg>

    </a>
    M690B Wiki
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/hardtekpt/M690B-Wiki" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    M690B-Wiki
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../Vehicle%20Setup/">Vehicle Setup</a>
          
            <label for="__nav_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Vehicle Setup" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Vehicle Setup
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2" type="checkbox" id="__nav_2_2" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../Hardware%20Setup/">Hardware Setup</a>
          
            <label for="__nav_2_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Hardware Setup" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          Hardware Setup
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Hardware%20Setup/onboard_computer/" class="md-nav__link">
        Onboard Computer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Hardware%20Setup/flight_computer/" class="md-nav__link">
        Flight Computer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Hardware%20Setup/radio_and_receiver/" class="md-nav__link">
        Radio and Receiver
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3" type="checkbox" id="__nav_2_3" checked>
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../">Software Setup</a>
          
            <label for="__nav_2_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Software Setup" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          Software Setup
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../os_installation/" class="md-nav__link">
        OS and ROS installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../vrpn_and_mavros/" class="md-nav__link">
        VRPN and MAVROS setup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../px4_configuration_checklist/" class="md-nav__link">
        PX4 Configuration Checklist
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Drone Control Stack Setup
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Drone Control Stack Setup
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#environment-setup" class="md-nav__link">
    Environment Setup
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#control-stack-overview" class="md-nav__link">
    Control Stack Overview
  </a>
  
    <nav class="md-nav" aria-label="Control Stack Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#simulation-flow" class="md-nav__link">
    Simulation flow
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#real-mission-flow" class="md-nav__link">
    Real mission flow
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ros-packages-overview" class="md-nav__link">
    ROS Packages Overview
  </a>
  
    <nav class="md-nav" aria-label="ROS Packages Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#drone_bringup" class="md-nav__link">
    drone_bringup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drone_description" class="md-nav__link">
    drone_description
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drone_worlds" class="md-nav__link">
    drone_worlds
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drone_launch" class="md-nav__link">
    drone_launch
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drone_gimmicks_library" class="md-nav__link">
    drone_gimmicks_library
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drone_utils_cpp" class="md-nav__link">
    drone_utils_cpp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mavros_cpp" class="md-nav__link">
    mavros_cpp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simulation-example" class="md-nav__link">
    Simulation example
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../usefull_packages/" class="md-nav__link">
        Usefull Packages
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../known_issues/" class="md-nav__link">
        Known Issues
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../Mission%20Logs/">Mission Logs</a>
          
            <label for="__nav_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Mission Logs" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Mission Logs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Mission%20Logs/05-07-2023/" class="md-nav__link">
        05-07-2023
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Mission%20Logs/13-07-2023/" class="md-nav__link">
        13-07-2023
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Mission%20Logs/20-07-2023/" class="md-nav__link">
        20-07-2023
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Mission%20Logs/27-07-2023/" class="md-nav__link">
        27-07-2023
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Mission%20Logs/28-07-2023/" class="md-nav__link">
        28-07-2023
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Mission%20Logs/22-09-2023/" class="md-nav__link">
        22-09-2023
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../roadmap/" class="md-nav__link">
        Roadmap
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
  <a href="https://github.com/hardtekpt/M690B-Wiki/edit/master/docs/Software Setup/drone_control_stack.md" title="Edit this page" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>



<h1 id="drone-control-stack-setup">Drone Control Stack Setup</h1>
<p>This section describes the steps followed to install the drone control stack on the onboard computer. This stack is composed of ROS packages which allow the vehicle to be controlled from ROS nodes using the available cpp UAV class. It should be noted that the steps described include everything that is needed to run simulations in adition to controlling the real drone.</p>
<h2 id="environment-setup">Environment Setup</h2>
<p>Before installing the ROS packages, it is necessary to create a workspace and install the PX4 firmware (only used for simulations).</p>
<ul>
<li>
<p>Creating a catkin workspace
    <div class="highlight"><pre><span></span><code>mkdir ~/uav/uav_ws/src
<span class="nb">cd</span> ~/uav/uav_ws
catkin_make
</code></pre></div></p>
</li>
<li>
<p>Installing the PX4 firmware
    <div class="highlight"><pre><span></span><code><span class="nb">cd</span> ~/uav
git clone --recursive https://github.com/PX4/PX4-Autopilot.git
<span class="nb">cd</span> PX4-Autopilot
git fetch --all --tags
git checkout v1.12.3 -b latest
git submodule update --init --recursive
make px4_sitl gazebo
</code></pre></div></p>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>While installing the PX4 firmware, some missing packages might need to be installed with pip. If pip is not available it can be installed with <code>sudo apt install python3-pip</code>.</p>
</div>
<ul>
<li>
<p>In order not to pollute the <code>bashrc</code> profile, a script was created to load the needed environment variables
    <div class="highlight"><pre><span></span><code><span class="nb">cd</span> ~/uav
touch setup.bash
</code></pre></div></p>
</li>
<li>
<p>Contents of the <code>setup.bash</code> file
    <div class="highlight"><pre><span></span><code><span class="nb">source</span> ~/uav/uav_ws/devel/setup.bash

<span class="nb">export</span> <span class="nv">CATKIN_WORKSPACE</span><span class="o">=</span>~/uav/uav_ws

<span class="nb">export</span> <span class="nv">GAZEBO_PLUGIN_PATH</span><span class="o">=</span><span class="nv">$GAZEBO_PLUGIN_PATH</span>:/home/jetson/uav/PX4-Autopilot/build_gazebo
<span class="nb">export</span> <span class="nv">GAZEBO_MODEL_PATH</span><span class="o">=</span><span class="nv">$GAZEBO_MODEL_PATH</span>:/home/jetson/uav/PX4-Autopilot/Tools/sitl_gazebo/models

<span class="nb">export</span> <span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span><span class="nv">$LD_LIBRARY_PATH</span>:/home/jetson/uav/PX4-Autopilot/build_gazebo
<span class="nb">export</span> <span class="nv">ROS_PACKAGE_PATH</span><span class="o">=</span><span class="nv">$ROS_PACKAGE_PATH</span>:/home/jetson/uav/PX4-Autopilot:/home/jetson/uav/PX4-Autopilot/Tools/sitl_gazebo

<span class="nb">source</span> /home/jetson/uav/PX4-Autopilot/Tools/setup_gazebo.bash /home/jetson/uav/PX4-Autopilot /home/jetson/uav/PX4-Autopilot/build/px4_sitl_default
</code></pre></div></p>
</li>
</ul>
<h2 id="control-stack-overview">Control Stack Overview</h2>
<p>Now that the environment is prepared, the code stack can be installed inside the created workspace. Below is a tree view of all the packages included in the stack. The packages listed here are available in <a href="https://github.com/hardtekpt/M690B-Wiki/tree/master/drone_control_stack/src">this repository</a>.</p>
<div class="highlight"><pre><span></span><code>src/
├── drone_bringup
├── drone_gazebo
│   ├── drone_description
│   └── drone_worlds
├── drone_launch
└── drone_library
    ├── drone_gimmicks_library
    ├── drone_utils_cpp
    └── mavros_cpp
</code></pre></div>
<h3 id="simulation-flow">Simulation flow</h3>
<pre class="mermaid"><code>graph TD
  A(&lt;b&gt;simulator_bringup.launch&lt;/b&gt; &lt;br&gt; drone_launch) --&gt; B(&lt;b&gt;vehicle_bringup.launch&lt;/b&gt; &lt;br&gt; drone_launch);
  A --&gt; C(&lt;b&gt;empty_world.launch&lt;/b&gt; &lt;br&gt; gazebo_ros);
  A -. simulator_bringup_rviz.launch .-&gt; G(&lt;b&gt;rviz&lt;/b&gt; &lt;br&gt; rviz);
  B --&gt; D(&lt;b&gt;single_vehicle_spawn.launch&lt;/b&gt; &lt;br&gt; drone_launch);
  B --&gt; E(&lt;b&gt;px4.launch&lt;/b&gt; &lt;br&gt; mavros);
  B --&gt; F(&lt;b&gt;drone_sim.launch&lt;/b&gt; &lt;br&gt; drone_bringup);</code></pre>
<h3 id="real-mission-flow">Real mission flow</h3>
<pre class="mermaid"><code>graph TD
  A(&lt;b&gt;real_bringup_rviz.launch&lt;/b&gt; &lt;br&gt; drone_launch) --&gt; B(&lt;b&gt;px4.launch&lt;/b&gt; &lt;br&gt; mavros);
  A --&gt; C(&lt;b&gt;drone_sim.launch&lt;/b&gt; &lt;br&gt; drone_bringup);
  A --&gt; G(&lt;b&gt;rviz&lt;/b&gt; &lt;br&gt; rviz);</code></pre>
<h2 id="ros-packages-overview">ROS Packages Overview</h2>
<h3 id="drone_bringup">drone_bringup</h3>
<p>The <code>drone_sim.launch</code> file loads the vehicle and main algorithm parameters and calls the ROS node that has the mission to be carried out.</p>
<div class="highlight"><pre><span></span><code>src/drone_bringup/
├── CMakeLists.txt
├── config
│   └── simulation
│       └── iris
│           └── config.yaml
├── launch
│   └── drone_sim.launch
└── package.xml
</code></pre></div>
<h3 id="drone_description">drone_description</h3>
<p>The <code>drone_description</code> package contains the <strong>Gazebo</strong> models for the vehicles used.</p>
<div class="highlight"><pre><span></span><code>src/drone_gazebo/drone_description/
├── CMakeLists.txt
├── models
│   └── iris
│       ├── iris.sdf.jinja
│       ├── iris.urdf
│       ├── meshes
│       │   ├── iris_prop_ccw.dae
│       │   ├── iris_prop_cw.dae
│       │   └── iris.stl
│       └── model.config
├── package.xml
└── scripts
    ├── jinja_gen.py
    ├── names.py
    ├── schema_download.bash
    ├── substitution_args.py
    └── validate_sdf.bash
</code></pre></div>
<h3 id="drone_worlds">drone_worlds</h3>
<p>The <code>drone_worlds</code> package contains the world files that can be used during simulations in <strong>Gzaebo</strong>.</p>
<div class="highlight"><pre><span></span><code>src/drone_gazebo/drone_worlds/
├── CMakeLists.txt
├── package.xml
└── worlds
    ├── baylands.world
    ├── boat.world
    ├── empty.world
    ├── hippocampus.world
    ├── hitl_iris.world
    ├── hitl_standard_vtol.world
    ├── iris_irlock.world
    ├── ksql_airport.world
    ├── mcmillan_airfield.world
    ├── ocean.world
    ├── sonoma_raceway.world
    ├── typhoon_h480.world
    ├── uuv_bluerov2_heavy.world
    ├── uuv_hippocampus.world
    ├── warehouse.world
    ├── windy.world
    └── yosemite.world
</code></pre></div>
<h3 id="drone_launch">drone_launch</h3>
<p>The <code>drone_launch</code> package contains several launch files that are used to run simulations and to run missions with the real drone.</p>
<div class="highlight"><pre><span></span><code>src/drone_launch/
├── CMakeLists.txt
├── launch
│   ├── real_bringup_rviz.launch
│   ├── rvizcfg.rviz
│   ├── simulator_bringup.launch
│   ├── simulator_bringup_rviz.launch
│   ├── single_vehicle_spawn.launch
│   └── vehicle_bringup.launch
└── package.xml
</code></pre></div>
<h3 id="drone_gimmicks_library">drone_gimmicks_library</h3>
<p>The <code>drone_gimmicks_library</code> package contains some useful macros to reduce the complexity of some common ROS operations like getting parameters.</p>
<div class="highlight"><pre><span></span><code>src/drone_library/drone_gimmicks_library/
├── CMakeLists.txt
├── include
│   └── drone_gimmicks_library
│       └── DroneGimmicks.h
├── package.xml
└── src
    └── DroneGimmicks.cpp
</code></pre></div>
<h3 id="drone_utils_cpp">drone_utils_cpp</h3>
<p>The <code>drone_utils_cpp</code> package contains some useful functions while working with drones, like converting between different coordinate frames and normalizing thrust values.</p>
<div class="highlight"><pre><span></span><code>src/drone_library/drone_utils_cpp/
├── CMakeLists.txt
├── doc
│   └── README.md
├── include
│   └── drone_utils_cpp
│       ├── DroneInfo.h
│       ├── DroneStatus.h
│       └── Utils.h
├── package.xml
└── src
    └── Utils.cpp
</code></pre></div>
<h3 id="mavros_cpp">mavros_cpp</h3>
<p>The <code>mavros_cpp</code> package contains the main class (<em>UAV</em>) which is used to control the drone as well as to get telemetry data.</p>
<div class="highlight"><pre><span></span><code>src/drone_library/mavros_cpp/
├── CMakeLists.txt
├── doc
│   └── README.md
├── include
│   └── mavros_cpp
│       ├── Actuators.h
│       ├── EKF.h
│       ├── Sensors.h
│       └── UAV.h
├── package.xml
└── src
    ├── offboard.cpp
    ├── telemetry.cpp
    └── UAV.cpp
</code></pre></div>
<h2 id="simulation-example">Simulation example</h2>
<p>After installing the code stack the provided <em>lissajous</em> example package can be executed in simulation. The <code>drone_sim.launch</code> file in the <code>drone_bringup</code> package should contain a call to the <code>lissajous</code> ROS node like so - <code>&lt;node pkg="lissajous" type="lissajous_node" name="lissajous" respawn="false" output="screen"/&gt;</code>.</p>
<ol>
<li>
<p>Build the workspace
    <div class="highlight"><pre><span></span><code><span class="nb">cd</span> ~/uav/uav_ws
catkin_make
</code></pre></div></p>
</li>
<li>
<p>Source the provided bash script
    <div class="highlight"><pre><span></span><code><span class="nb">cd</span> ~/uav
<span class="nb">source</span> setup.bash
</code></pre></div></p>
</li>
<li>
<p>Run the simulation
    <div class="highlight"><pre><span></span><code>roslaunch drone_launch simulator_bringup.launch
</code></pre></div></p>
<p><img alt="Lissajous Gazebo Simulation" src="../../assets/simulation_lissajous.gif" title="Lissajous Gazebo Simulation" /></p>
</li>
</ol>

              
            </article>
            
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
      
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" hidden>
      
        
        <a href="../px4_configuration_checklist/" class="md-footer__link md-footer__link--prev" aria-label="Previous: PX4 Configuration Checklist" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              PX4 Configuration Checklist
            </div>
          </div>
        </a>
      
      
        
        <a href="../usefull_packages/" class="md-footer__link md-footer__link--next" aria-label="Next: Usefull Packages" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Usefull Packages
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.tracking", "navigation.sections", "toc.follow", "navigation.top", "search.suggest", "search.highlight", "search.share", "navigation.footer", "toc.integrate", "navigation.indexes", "navigation.tabs"], "search": "../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.6c7ad80a.min.js"></script>
      
        <script src="../../stylesheets/js.js"></script>
      
    
  </body>
</html>